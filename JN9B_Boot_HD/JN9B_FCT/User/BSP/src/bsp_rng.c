/**********************************************************************************************************
** Company     : JNE WuHan Co.,Ltd.
** Project     :
** --------------------------------------------------------------------------------------------------------
** File name   : bsp_rng.c
** Author      : Huang Cheng
** Date        : 2021-11-25
** Description : bsp_rng source file
**********************************************************************************************************/

/**********************************************************************************************************
**                                          头文件引用区
**********************************************************************************************************/
#include "bsp_rng.h"
#include "bsp_dwt.h"
#include "bsp_debug.h"

/**********************************************************************************************************
**                                         全局变量定义区
**********************************************************************************************************/


/**********************************************************************************************************
**                                           函数声明区
**********************************************************************************************************/


/**********************************************************************************************************
**                                           应用函数区
**********************************************************************************************************/

/**********************************************************************************************************
**	函 数 名 : bsp_InitRNG()
**	功能说明 : 初始化RNG配置
**	形    参 : 无
**	返 回 值 : 无
**********************************************************************************************************/
void bsp_InitRNG(void)
{
    /* Config Pclk4 clock   PCLK4 = System clock / 8 = 1MHZ*/
    CLK_PERI_ClkConfig(CLK_PERI_CLK_PCLK);
    CLK_ClkDiv(CLK_CATE_PCLK4, CLK_PCLK4_DIV8);
	
	/* Enable TRNG. */
    PWC_Fcg0PeriphClockCmd(PWC_FCG0_TRNG, Enable);
    /* Shift 64 times */
    TRNG_SetShiftCnt(TRNG_SHIFT_COUNT_64);

    /* Disable the Load function */
    TRNG_ReloadCmd(TRNG_RELOAD_DISABLE);
}

/**********************************************************************************************************
**	函 数 名 : RNG_Get_RandomRange()
**	功能说明 : 生成一个指定范围随机数
**	形    参 : min：范围下限 max：范围上限
**	返 回 值 : 生成数
**********************************************************************************************************/
uint32_t RNG_Get_RandomRange(uint32_t min, uint32_t max)
{
	uint32_t RngNum = 0;
	
	/* Start TRNG */
    (void)TRNG_Generate(&RngNum);
	
	printf("随机数生成的原始数据是 %d\n", RngNum);
	
    return (RngNum%(max-min+1) + min);

}

/**********************************************************************************************************
**                                          End Of File
**********************************************************************************************************/
